<AppLockerPolicy Version="1">
  <RuleCollection Type="Appx" EnforcementMode="AuditOnly">
    <FilePublisherRule Id="a9e18c21-ff8f-43cf-b9fc-db40eed693ba" Name="(Default Rule) All signed packaged apps" Description="Allows members of the Everyone group to run packaged apps that are signed." UserOrGroupSid="S-1-1-0" Action="Allow">
      <Conditions>
        <FilePublisherCondition PublisherName="*" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="0.0.0.0" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
    </FilePublisherRule>
  </RuleCollection>
  <RuleCollection Type="Dll" EnforcementMode="AuditOnly">
    <FilePathRule Id="3e110d28-dbde-47f7-b0ae-c44b52b11b38" Name="[TOGGLE TEMPORARY] Allow Everything in AppData Local (Change path to your username)" Description="--- Always remember to change it back to Deny after finishing.&#xD;&#xA;---&#xA;An exception is added for signed files so that even when this is set to Deny, it will not override the rule to allow signed files." UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePathCondition Path="C:\Users\WHATEVERUSERNAME\AppData\Local\Temp\*" />
      </Conditions>
      <Exceptions>
        <FilePublisherCondition PublisherName="*" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Exceptions>
    </FilePathRule>
    <FilePublisherRule Id="a2b2ecb6-03e1-4606-9553-59118ac27a5a" Name="---- Starter Rules: Allow All Signed DLLs" Description="" UserOrGroupSid="S-1-1-0" Action="Allow">
      <Conditions>
        <FilePublisherCondition PublisherName="*" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="0.0.0.0" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
    </FilePublisherRule>
  </RuleCollection>
  <RuleCollection Type="Exe" EnforcementMode="AuditOnly">
    <FilePathRule Id="602bf8c2-2a4f-4009-8cae-94894c9f05ef" Name="[TOGGLE TEMPORARY] Allow Everything in AppData Local (Change path to your username)" Description="--- Always remember to change it back to Deny after finishing. ---&#xA;&#xD;&#xA;An exception is added for signed files so that even when this is set to Deny, it will not override the rule to allow signed files." UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePathCondition Path="C:\Users\WHATEVERUSERNAME\AppData\Local\Temp\*" />
      </Conditions>
      <Exceptions>
        <FilePublisherCondition PublisherName="*" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Exceptions>
    </FilePathRule>
    <FilePublisherRule Id="459459ce-b500-49f5-b1e3-1f9a06ce6ae4" Name="---- Starter Rules: Allow All Signed Executables" Description="" UserOrGroupSid="S-1-1-0" Action="Allow">
      <Conditions>
        <FilePublisherCondition PublisherName="*" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
    </FilePublisherRule>
    <FilePathRule Id="2acf4e9c-e213-49e6-857c-6b32e436696e" Name="---- Starter Rules: Block *.com With Publisher Exceptions" Description="" UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePathCondition Path="*.com" />
      </Conditions>
      <Exceptions>
        <FilePublisherCondition PublisherName="O=MICROSOFT CORPORATION, L=REDMOND, S=WASHINGTON, C=US" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
        <FilePublisherCondition PublisherName="O=ADOBE INC., L=SAN JOSE, S=CA, C=US" ProductName="ADOBE AFTER EFFECTS 2023" BinaryName="AFTERFX.EXE">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Exceptions>
    </FilePathRule>
    <FilePathRule Id="b15c8ac6-0746-419e-a28e-13a5eb2d59d1" Name="---- Starter Rules: Block All .scr" Description="" UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePathCondition Path="*.scr" />
      </Conditions>
    </FilePathRule>
    <FileHashRule Id="2954382f-ea1b-4c87-ad79-7bf67814e0d1" Name="---- Starter Rules: Block NirCMD" Description="Legitimate software but used and abused by some malware. Various Versions Included" UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FileHashCondition>
          <FileHash Type="SHA256" Data="0xA34B17A66ABE9402FA73BE0975BD5740AB445A0AF69C451D1195D34B2F7BA214" SourceFileName="nircmd.exe" SourceFileLength="45568" />
          <FileHash Type="SHA256" Data="0x9C45C850FD4CAFB33E3968DC0C0222D0DB118F12688F9F832EB1E131F2E395B0" SourceFileName="nircmdc.exe" SourceFileLength="44544" />
          <FileHash Type="SHA256" Data="0x80E809BB52AFC788F9787795B565E4713CF7BC3F8A2642FD10E23543C6CB88C6" SourceFileName="nircmd.exe" SourceFileLength="119296" />
          <FileHash Type="SHA256" Data="0x483950B5FBC16FB778D9E7B44C6C505220B291A811C0F2C6B2053E921145912E" SourceFileName="nircmdc.exe" SourceFileLength="117248" />
          <FileHash Type="SHA256" Data="0xD9CDFFC752897150F4D524FAAB56FC7118549E6C9A5BD3018356D2F52A503C21" SourceFileName="nircmd (12).exe" SourceFileLength="45568" />
          <FileHash Type="SHA256" Data="0x63C62D1B7A5CF17DF8086D3D19F0416696A57B919F9EB207EB5980029A5C9A02" SourceFileName="nircmd.exe" SourceFileLength="119296" />
          <FileHash Type="SHA256" Data="0x6ACD30CDB2C7421349AC4A04B95B54CBACF3E1D6E659ADE8A060382F34BC59BA" SourceFileName="nircmdc (9).exe" SourceFileLength="44544" />
          <FileHash Type="SHA256" Data="0xE4D7B6C6CF9EDEDAC5A35781590982FCC6A7B3E5434E2A0BBD25878DD878B058" SourceFileName="nircmdc (11).exe" SourceFileLength="117248" />
          <FileHash Type="SHA256" Data="0xD4D1A3C69572D023DC573BC7227AC50F1EF44796AC514F8F8A1A90DD7920F3B9" SourceFileName="nircmd (1).exe" SourceFileLength="45568" />
          <FileHash Type="SHA256" Data="0x6FA33F81DBAF27C16EE3828FF539A8EDBE35DB65DC74A6F6584FFC4E9630C9C8" SourceFileName="nircmd (6).exe" SourceFileLength="118784" />
          <FileHash Type="SHA256" Data="0xFE31B1A8DD290D9BC3D46747B6BB3FFDB553BA1F6B3AB8F3C5BC959C7AD5CC42" SourceFileName="nircmdc (5).exe" SourceFileLength="44544" />
          <FileHash Type="SHA256" Data="0x5BEC64432D38B35DF985C860170B2C82092725A3A27DDC4173483F1FBC927AC7" SourceFileName="nircmdc (7).exe" SourceFileLength="117248" />
          <FileHash Type="SHA256" Data="0xC248EFDF450D7D115DE88BE9C11F35735D4532494AFABB2FB432D4DDACE059F4" SourceFileName="nircmd (16).exe" SourceFileLength="45056" />
          <FileHash Type="SHA256" Data="0x710510FF7AC8120D766C8A475B1D3CC0C9B8995676CFADA5EF5DAD4BCFA68BD8" SourceFileName="nircmd (4).exe" SourceFileLength="116736" />
          <FileHash Type="SHA256" Data="0x3227FFE917BE98C62D4F7CE85AD025F7B9E7D1170DEB60B20CCC26A3B3FC1785" SourceFileName="nircmdc (6).exe" SourceFileLength="44032" />
          <FileHash Type="SHA256" Data="0x521CE1C7F8D27622D6DA9D759733642C7A0AF0229A70B439C5DB1AAD08482F3D" SourceFileName="nircmdc (4).exe" SourceFileLength="115200" />
          <FileHash Type="SHA256" Data="0x4E6D4310B81B957367040AF8D7AE4B36573570E9F63457ABD2FA1CEACE1B5C6C" SourceFileName="nircmd (8).exe" SourceFileLength="44544" />
          <FileHash Type="SHA256" Data="0x191AA8EA62C0F3A285618E9C38853DA6456CA29BAC61FE9DCA2E099BBEBCF9B2" SourceFileName="nircmd (5).exe" SourceFileLength="116736" />
          <FileHash Type="SHA256" Data="0x8ACE2E6B62B813561DCD936D7480F9C26BA341DFFC9C39F2419A8EE82F7F96CB" SourceFileName="nircmdc (3).exe" SourceFileLength="44032" />
          <FileHash Type="SHA256" Data="0xCAF9A6B819431C48D30CBA890B9C710E20073B0472B7D171D88CE2CD8FC8B30F" SourceFileName="nircmdc (2).exe" SourceFileLength="115200" />
          <FileHash Type="SHA256" Data="0xCBAED71715073CB61619F2B4EFB471C35B8E5A89EDE896109A2698B760622F86" SourceFileName="nircmd (9).exe" SourceFileLength="44032" />
          <FileHash Type="SHA256" Data="0x7E91E1858014A03D97F02BDD0FC0CED27B029C1F9DF76E67CA71604FB85C9C16" SourceFileName="nircmd (2).exe" SourceFileLength="115712" />
          <FileHash Type="SHA256" Data="0xFCFE0E13980D870CAC03F52715B18EC783E8CE776DCADBCCF897AFD58FFCF1AC" SourceFileName="nircmdc (10).exe" SourceFileLength="43520" />
          <FileHash Type="SHA256" Data="0x157508FBD66879E6C9E812DB8BA77DB77127883705B4EE0605EC779DA063235A" SourceFileName="nircmdc (1).exe" SourceFileLength="113664" />
          <FileHash Type="SHA256" Data="0x9190E30D24061DB9E5F47AFBBD527BB0BD933604A2220704124F1EED712A64F8" SourceFileName="nircmd (14).exe" SourceFileLength="43520" />
          <FileHash Type="SHA256" Data="0xFDE98AFFF53543D798067019FAEBC049288AFCF3FE9CA7970BF81A57C71B309E" SourceFileName="nircmdc (15).exe" SourceFileLength="42496" />
        </FileHashCondition>
      </Conditions>
    </FileHashRule>
    <FilePublisherRule Id="2febde46-b64c-4daf-be9b-1c3f71d5c55b" Name="---- Starter Rules: Block Powershell ISE Outside Original Paths" Description="" UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePublisherCondition PublisherName="O=MICROSOFT CORPORATION, L=REDMOND, S=WASHINGTON, C=US" ProductName="MICROSOFT® WINDOWS® OPERATING SYSTEM" BinaryName="POWERSHELL_ISE.EXE">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
      <Exceptions>
        <FilePathCondition Path="C:\Windows\System32\WindowsPowerShell\*" />
        <FilePathCondition Path="C:\Windows\SysWOW64\WindowsPowerShell\*" />
        <FilePathCondition Path="C:\Windows\WinSxS\*" />
      </Exceptions>
    </FilePublisherRule>
    <FilePublisherRule Id="4f19138b-d37a-4874-a8a8-7cf08cf1d899" Name="---- Starter Rules: Block Powershell Outside Original Paths" Description="" UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePublisherCondition PublisherName="O=MICROSOFT CORPORATION, L=REDMOND, S=WASHINGTON, C=US" ProductName="MICROSOFT® WINDOWS® OPERATING SYSTEM" BinaryName="POWERSHELL.EXE">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
      <Exceptions>
        <FilePathCondition Path="C:\Windows\System32\WindowsPowerShell\*" />
        <FilePathCondition Path="C:\Windows\SysWOW64\WindowsPowerShell\*" />
        <FilePathCondition Path="C:\Windows\WinSxS\*" />
      </Exceptions>
    </FilePublisherRule>
    <FilePublisherRule Id="d32cc361-8151-41bb-9042-d150851d9d3a" Name="---- Starter Rules: Block Process Hacker Publisher" Description="Legitimate software but sometimes used and abused by malware." UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePublisherCondition PublisherName="O=WEN JIA LIU, L=SYDNEY, S=NEW SOUTH WALES, C=AU" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
    </FilePublisherRule>
    <FilePublisherRule Id="5a885b3f-f697-47f8-aa1a-acfb98af3fa9" Name="---- Starter Rules: Block PWSH ---- Starter Rules: Outside Normal Directory (Change the one exception path to use your username)" Description="" UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePublisherCondition PublisherName="O=MICROSOFT CORPORATION, L=REDMOND, S=WASHINGTON, C=US" ProductName="POWERSHELL" BinaryName="PWSH.DLL">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
      <Exceptions>
        <FilePathCondition Path="C:\Program Files\PowerShell\*" />
        <FilePathCondition Path="C:\Program Files\WindowsApps\Microsoft.PowerShell_7.3.6.0_x64__8wekyb3d8bbwe\*" />
        <FilePathCondition Path="C:\Users\WHATEVERUSERNAME\AppData\Local\Microsoft\WindowsApps\*" />
      </Exceptions>
    </FilePublisherRule>
    <FilePublisherRule Id="1ed68ee9-02ba-4956-9abc-22be38da9bf7" Name="---- Starter Rules: Block PWSH.exe outside Normal Directories (Change the one exception path to use your username)" Description="" UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePublisherCondition PublisherName="O=MICROSOFT CORPORATION, L=REDMOND, S=WASHINGTON, C=US" ProductName="MICROSOFT® WINDOWS® OPERATING SYSTEM" BinaryName="PWSH.EXE">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
      <Exceptions>
        <FilePathCondition Path="C:\Program Files\PowerShell\*" />
        <FilePathCondition Path="C:\Program Files\WindowsApps\Microsoft.PowerShell_7.3.6.0_x64__8wekyb3d8bbwe\*" />
        <FilePathCondition Path="C:\Users\WHATEVERUSERNAME\AppData\Local\Microsoft\WindowsApps\*" />
      </Exceptions>
    </FilePublisherRule>
  </RuleCollection>
  <RuleCollection Type="Msi" EnforcementMode="AuditOnly">
    <FilePublisherRule Id="b7af7102-efde-4369-8a89-7a6a392d1473" Name="(Default Rule) All digitally signed Windows Installer files" Description="Allows members of the Everyone group to run digitally signed Windows Installer files." UserOrGroupSid="S-1-1-0" Action="Allow">
      <Conditions>
        <FilePublisherCondition PublisherName="*" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="0.0.0.0" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
    </FilePublisherRule>
  </RuleCollection>
  <RuleCollection Type="Script" EnforcementMode="AuditOnly">
    <FilePathRule Id="7db12d15-41b3-42b3-ae96-1e2288db9374" Name="[TOGGLE TEMPORARY] Allow Everything in AppData Local (Change path to your username)" Description="--- Always remember to change it back to Deny after finishing. ---&#xD;&#xA;&#xA;An exception is added for signed files so that even when this is set to Deny, it will not override the rule to allow signed files." UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePathCondition Path="C:\Users\WHATEVERUSERNAME\AppData\Local\Temp\*" />
      </Conditions>
      <Exceptions>
        <FilePublisherCondition PublisherName="*" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Exceptions>
    </FilePathRule>
    <FilePathRule Id="1988cf8e-8caa-46ca-878f-d638f0329a8b" Name="---- Starter Rules: Block init.ps1" Description="" UserOrGroupSid="S-1-1-0" Action="Deny">
      <Conditions>
        <FilePathCondition Path="*\init.ps1" />
      </Conditions>
    </FilePathRule>
    <FilePublisherRule Id="34c794cd-d3cf-4028-8aa4-c3f9de1a59ab" Name="---- Starter Rules: Allow All Signed Scripts" Description="" UserOrGroupSid="S-1-1-0" Action="Allow">
      <Conditions>
        <FilePublisherCondition PublisherName="*" ProductName="*" BinaryName="*">
          <BinaryVersionRange LowSection="*" HighSection="*" />
        </FilePublisherCondition>
      </Conditions>
    </FilePublisherRule>
  </RuleCollection>
</AppLockerPolicy>